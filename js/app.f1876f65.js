(function(){"use strict";var e={3488:function(e,t,a){var n=a(9242),i=a(3396);function r(e,t,a,n,r,s){const o=(0,i.up)("auth-form");return(0,i.wg)(),(0,i.j4)(o)}var s=a(7139);const o={class:"auth__container"},l={key:2,class:"auth__error"};function u(e,t,a,n,r,u){const d=(0,i.up)("email-auth"),c=(0,i.up)("success-auth");return(0,i.wg)(),(0,i.iD)("div",{class:"auth",style:(0,s.j5)({"background-image":`url(${u.bgUrl})`})},[(0,i._)("div",o,["email"===e.currentView?((0,i.wg)(),(0,i.j4)(d,{key:0,ref:"email","is-loading":e.isLoading,onSetView:u.setView,onCheckEmail:u.checkEmail,onLogIn:u.logIn,onSignUp:u.signUp,onViewChanged:t[0]||(t[0]=t=>e.error="")},null,8,["is-loading","onSetView","onCheckEmail","onLogIn","onSignUp"])):(0,i.kq)("",!0),"success"===e.currentView?((0,i.wg)(),(0,i.j4)(c,{key:1,onSetView:u.setView},null,8,["onSetView"])):(0,i.kq)("",!0),e.error?((0,i.wg)(),(0,i.iD)("div",l,(0,s.zw)(e.error),1)):(0,i.kq)("",!0)])],4)}const d=e=>((0,i.dD)("data-v-a787f08a"),e=e(),(0,i.Cn)(),e),c={class:"success-auth"},m=d((()=>(0,i._)("b",null,"you enjoy",-1))),p={ref:"link",href:"mailto:vanhocker@gmail.com"};function f(e,t,a,n,r,s){const o=(0,i.up)("h1-text"),l=(0,i.up)("p-text"),u=(0,i.up)("v-button");return(0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(o,null,{default:(0,i.w5)((()=>[(0,i.Uk)("ðŸŽ‰ Congratulation")])),_:1}),(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Uk)("You're finally here!")])),_:1}),(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Uk)("If "),m,(0,i.Uk)(", would be great to "),(0,i._)("a",p,"send me",512),(0,i.Uk)(" another challenges.")])),_:1}),(0,i.Wm)(u,{class:"button",onClick:s.sendEmail},{default:(0,i.w5)((()=>[(0,i.Uk)("Here we go!")])),_:1},8,["onClick"])])}const h={class:"h1"};function g(e,t,a,n,r,s){return(0,i.wg)(),(0,i.iD)("h1",h,[(0,i.WI)(e.$slots,"default",{},void 0,!0)])}var w={name:"H1Text"},v=a(89);const b=(0,v.Z)(w,[["render",g],["__scopeId","data-v-ef7f1b96"]]);var y=b;const k=["type","value","name","disabled","autofocus","aria-label","title"];function _(e,t,a,n,r,s){return(0,i.wg)(),(0,i.iD)("button",{class:"button",type:a.type,value:a.value,name:a.name,disabled:a.disabled,autofocus:a.autofocus,"aria-label":a.label,title:a.label},[(0,i.WI)(e.$slots,"default",{},void 0,!0)],8,k)}var U={name:"VButton",props:{type:{type:String,default:"submit"},value:{type:[String,Number],default:""},name:{type:String,default:""},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},label:{type:String,default:""}}};const V=(0,v.Z)(U,[["render",_],["__scopeId","data-v-1a390e9c"]]);var E=V;function W(e,t,a,n,r,s){return(0,i.wg)(),(0,i.iD)("p",null,[(0,i.WI)(e.$slots,"default")])}var C={name:"PText"};const S=(0,v.Z)(C,[["render",W]]);var x=S,I={name:"SuccessAuth",components:{PText:x,VButton:E,H1Text:y},methods:{sendEmail(){this.$refs.link.click()}}};const L=(0,v.Z)(I,[["render",f],["__scopeId","data-v-a787f08a"]]);var q=L;const B=e=>((0,i.dD)("data-v-7fc7f4e4"),e=e(),(0,i.Cn)(),e),D={class:"email-steps"},O=B((()=>(0,i._)("b",null,"test@gmail.com",-1))),P=B((()=>(0,i._)("b",null,"Test911",-1))),$={class:"email-steps__title"},j={class:"email-steps__title"};function T(e,t,a,r,o,l){const u=(0,i.up)("h1-text"),d=(0,i.up)("p-text"),c=(0,i.up)("v-input"),m=(0,i.up)("v-button"),p=(0,i.up)("back-icon");return(0,i.wg)(),(0,i.iD)("div",D,["email"===e.currentView?((0,i.wg)(),(0,i.iD)("form",{key:0,id:"continue",class:"email-steps__step",onSubmit:t[1]||(t[1]=(0,n.iM)((function(){return l.checkEmail&&l.checkEmail(...arguments)}),["prevent"]))},[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Log in or sign up")])),_:1}),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Uk)("We'll check if you have an account, and help create one if you don't.")])),_:1}),(0,i.Wm)(d,{class:"auth__description"},{default:(0,i.w5)((()=>[(0,i.Uk)("For test login, use email: "),O,(0,i.Uk)(", password: "),P,(0,i.Uk)(".")])),_:1}),(0,i.Wm)(c,{modelValue:e.formEmail,"onUpdate:modelValue":t[0]||(t[0]=t=>e.formEmail=t),name:"email",label:"Email (personal or work)",placeholder:"mark@example.com",disabled:a.isLoading,pattern:e.validationPatterns.email,autofocus:"",required:""},null,8,["modelValue","disabled","pattern"]),(0,i.Wm)(m,{class:"button",disabled:a.isLoading},{default:(0,i.w5)((()=>[(0,i.Uk)("Continue")])),_:1},8,["disabled"])],32)):(0,i.kq)("",!0),"signup"===e.currentView?((0,i.wg)(),(0,i.iD)("form",{key:1,id:"sign-up",class:"email-steps__step",onSubmit:t[4]||(t[4]=(0,n.iM)((function(){return l.handleSignUp&&l.handleSignUp(...arguments)}),["prevent"]))},[(0,i._)("div",$,[(0,i._)("button",{type:"button",class:"back-button",onClick:t[2]||(t[2]=e=>l.setView("email"))},[(0,i.Wm)(p)]),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Create your account")])),_:1})]),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Uk)("You're creating a Martians Form account using "+(0,s.zw)(e.formEmail),1)])),_:1}),(0,i.Wm)(c,{modelValue:e.formEmail,"onUpdate:modelValue":t[3]||(t[3]=t=>e.formEmail=t),name:"email",type:"hidden"},null,8,["modelValue"]),(0,i.Wm)(c,{ref:"signupPassword",label:"Password",name:"password1",type:"password",placeholder:"Enter password",disabled:a.isLoading,pattern:e.validationPatterns.password,autofocus:"",required:""},null,8,["disabled","pattern"]),(0,i.Wm)(c,{label:"Retype password",name:"password2",type:"password",placeholder:"Enter password again",pattern:e.validationPatterns.password,disabled:a.isLoading,required:""},null,8,["pattern","disabled"]),(0,i.Wm)(m,{class:"button",disabled:a.isLoading},{default:(0,i.w5)((()=>[(0,i.Uk)("Create account")])),_:1},8,["disabled"])],32)):(0,i.kq)("",!0),"login"===e.currentView?((0,i.wg)(),(0,i.iD)("form",{key:2,id:"log-in",class:"email-steps__step",onSubmit:t[7]||(t[7]=(0,n.iM)((function(){return l.handleLogIn&&l.handleLogIn(...arguments)}),["prevent"]))},[(0,i._)("div",j,[(0,i._)("button",{type:"button",class:"back-button",onClick:t[5]||(t[5]=e=>l.setView("email"))},[(0,i.Wm)(p)]),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Finish logging in")])),_:1})]),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Once you enter the password, you'll be all logged in.")])),_:1}),(0,i.Wm)(c,{modelValue:e.formEmail,"onUpdate:modelValue":t[6]||(t[6]=t=>e.formEmail=t),name:"email",type:"hidden"},null,8,["modelValue"]),(0,i.Wm)(c,{label:"Password",name:"password",placeholder:"Enter password",type:"password",pattern:e.validationPatterns.password,disabled:a.isLoading,autofocus:"",required:""},null,8,["pattern","disabled"]),(0,i.Wm)(m,{class:"button",disabled:a.isLoading},{default:(0,i.w5)((()=>[(0,i.Uk)("Continue")])),_:1},8,["disabled"])],32)):(0,i.kq)("",!0)])}const Z={class:"input"},A=["for"],M=["id","type","value","name","required","disabled","autofocus","pattern","placeholder","autocomplete","inputmode"];function F(e,t,a,n,r,o){return(0,i.wg)(),(0,i.iD)("div",Z,[a.label?((0,i.wg)(),(0,i.iD)("label",{key:0,for:`input_${a.name}`},(0,s.zw)(a.label),9,A)):(0,i.kq)("",!0),(0,i._)("input",{id:`input_${a.name}`,ref:"input",type:a.type,value:a.modelValue,name:a.name,required:a.required,disabled:a.disabled,autofocus:a.autofocus,pattern:a.pattern,placeholder:a.placeholder,autocomplete:a.type,inputmode:a.type,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,M)])}var z={name:"VInput",props:{name:{type:String,default:"",required:!0},type:{type:String,default:"text"},modelValue:{type:String,default:""},label:{type:String,default:""},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},required:{type:Boolean,default:!1},pattern:{type:String,default:void 0},placeholder:{type:String,default:""}},emits:["update:modelValue"],mounted(){this.autofocus&&this.$refs.input.focus()}};const H=(0,v.Z)(z,[["render",F],["__scopeId","data-v-125ca4dc"]]);var R=H;const Y={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},N=(0,i._)("path",{fill:"currentColor",d:"M15.45 17.97 9.5 12.01a.25.25 0 0 1 0-.36l5.87-5.87a.75.75 0 0 0-1.06-1.06l-5.87 5.87c-.69.68-.69 1.8 0 2.48l5.96 5.96a.75.75 0 0 0 1.06-1.06z"},null,-1),G=[N];function J(e,t,a,n,r,s){return(0,i.wg)(),(0,i.iD)("svg",Y,G)}var K={name:"BackIcon"};const Q=(0,v.Z)(K,[["render",J]]);var X=Q,ee={name:"EmailAuth",components:{BackIcon:X,H1Text:y,VButton:E,VInput:R,PText:x},props:{userEmail:{type:String,default:""},isLoading:{type:Boolean,default:!1}},emits:["check-email","set-view","sign-up","log-in","view-changed"],data:()=>({formEmail:"",views:["email","login","signup"],currentView:"email",validationPatterns:{password:"^.{6,}$",email:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$"}}),methods:{checkEmail(){this.$emit("check-email",this.formEmail)},handleSignUp(e){this.$emit("sign-up",e)},handleLogIn(e){this.$emit("log-in",e)},setView(e){-1!==this.views.indexOf(e)&&(this.currentView=e,this.$emit("view-changed"))}}};const te=(0,v.Z)(ee,[["render",T],["__scopeId","data-v-7fc7f4e4"]]);var ae=te;const ne=()=>{const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")},ie=e=>e?e.trim():e,re=e=>[...e.target.elements].reduce((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;const a=t.getAttribute("name");return a&&(e[a]=ie(t.value)),e}),{});class se{constructor(e,t){this.user={id:Math.random(),email:e,password:t}}get(){return this.user}}class oe{constructor(){const e=new se("test@gmail.com","Test911");this.users={[e.user.id]:{...e.user}},this.errorCodes={404:"User not found",400:"Wrong data",500:"User already exists",401:"Wrong email or password"}}async request(){return new Promise((e=>setTimeout(e,1500)))}getUserByEmail(e){return Object.values(this.users).find((t=>t.email===e))}async hasUser(e){return await this.request(),!!this.getUserByEmail(e)}async logIn(e){let{email:t,password:a}=e;await this.request();const n=this.getUserByEmail(t);if(!n)throw new Error(this.errorCodes[404]);if(n.password!==a)throw await Promise.reject(this.errorCodes[401]),new Error(this.errorCodes[401]);const{id:i}=n;return{id:i,email:t}}async createUser(e){let{email:t,password:a}=e;if(await this.request(),!t||!a)throw new Error(this.errorCodes[400]);if(this.getUserByEmail(t))throw new Error(this.errorCodes[500]);const n=new se(t,a),{id:i,name:r}=n.get();return this.users[i]={id:i,name:r},this.users[i]}}var le=oe;const ue=new le;var de={name:"AuthForm",components:{EmailAuth:ae,SuccessAuth:q},data:()=>({views:["email","success"],currentView:"email",error:"",isLoading:!1,user:null}),computed:{bgUrl(){return ne()?"bg.webp":"bg.png"}},methods:{setView(e){-1!==this.views.indexOf(e)&&(this.currentView=e)},async checkEmail(e){this.isLoading=!0;const t=await ue.hasUser(e.trim()),a=t?"login":"signup";this.isLoading=!1,this.$refs.email.setView(a)},async signUp(e){const t=re(e),{email:a,password1:n,password2:i}=t;if(n===i){this.error="",this.isLoading=!0;try{this.user=await ue.createUser({email:a,password:n})}catch(r){return void(this.error=r)}finally{this.isLoading=!1}this.setView("success")}else this.error="Passwords should be the same"},async logIn(e){const t=re(e),{email:a,password:n}=t;this.error="",this.isLoading=!0;try{this.user=await ue.logIn({email:a,password:n})}catch(i){return void(this.error=i)}finally{this.isLoading=!1}this.setView("success")}}};const ce=(0,v.Z)(de,[["render",u],["__scopeId","data-v-7f94b7ac"]]);var me=ce,pe={name:"App",components:{AuthForm:me}};const fe=(0,v.Z)(pe,[["render",r]]);var he=fe;(0,n.ri)(he).mount("#app")}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,i,r){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],r=e[d][2];for(var o=!0,l=0;l<n.length;l++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(o=!1,r<s&&(s=r));if(o){e.splice(d--,1);var u=i();void 0!==u&&(t=u)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,r,s=n[0],o=n[1],l=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var d=l(a)}for(t&&t(n);u<s.length;u++)r=s[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},n=self["webpackChunkmartians_login"]=self["webpackChunkmartians_login"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(3488)}));n=a.O(n)})();
//# sourceMappingURL=app.f1876f65.js.map